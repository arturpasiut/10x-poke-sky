# Architektura UI dla 10x-poke-sky
## 1. Przegląd struktury UI
- Warstwa shell łączy nagłówek, obszar treści i globalne powiadomienia w domyślnym trybie dark, reagując na preferencje systemu i skalując layout w oparciu o breakpoints Tailwind (sm/md/lg/xl).
- Struktura widoków obejmuje moduły: onboarding/auth, strona główna, katalog Pokémonów, widok szczegółowy, katalog ruchów, ulubione oraz pełnoekranowy czat AI; pokrywa to user stories US-001-US-006 z PRD.
- Stan domenowy zarządzany jest przez store'y Zustand (`useAuthStore`, `useSearchStore`, `useFavoritesStore`), synchronizowane z Supabase i czyszczone przy wylogowaniu; brak dodatkowego cache'u klienta zgodnie z MVP.
- Komunikacja z API przechodzi przez warstwę usług z centralnym przechwytywaniem błędów; globalne toasty i komunikaty inline mapują kody 401/429/500 na czytelne statusy dla użytkownika.
- Skeletony dla list, kart detail i czatu maskują opóźnienia (docelowo <1 s dla wyszukiwania, <2 s dla home), a puste stany kierują do czatu AI lub ekranu logowania, ograniczając punkty bólu identyfikowane w PRD.
- Bezpieczeństwo obejmuje ochronę tras ulubionych, gating akcji dodawania, walidację formularzy auth i obsługę JWT, a dostępność zapewniają kontrasty WCAG AA, focus ringi, aria-live dla wyników i odpowiedzi AI oraz alt texty sprite'ów.

## 2. Lista widoków
- Shell & Nawigacja globalna | Ścieżka: layout shell | Główny cel: utrzymanie spójnego layoutu, nawigacji i warstwy feedbacku dla wszystkich ekranów | Kluczowe informacje: logo/aplikacja, stan sesji (zalogowany/gość), skróty do Pokédex, Moves, Favorites, AI, slot na breadcrumbs i toasty | Kluczowe komponenty: `HeaderBar`, `NavLinks`, `UserMenu`, `ThemeToggle`, `MobileDrawer`, `ToastStack`, `LoadingIndicator` | UX/A11y/Bezpieczeństwo: dark mode z wysokim kontrastem, focus trap w drawerze, aria-labels dla ikon, pokazywanie stanu aktywnego nawigacji, ukrywanie/disable akcji wymagających auth z tooltipem informacyjnym | Powiązane API: Supabase Auth session heartbeat | User stories: US-001-US-006 (nawigacja między przepływami) | Spełnia wymagania: responsywność i dostępność (PRD sekcja 7), logowanie dostępne w nagłówku (US-005).
- Uwierzytelnianie (logowanie/rejestracja) | Ścieżka: `/auth` | Główny cel: bezpieczne logowanie, rejestracja i odzyskiwanie hasła z możliwością kontynuacji jako gość | Kluczowe informacje: formularze email/hasło, walidacje (minimalna długość, powtórzenie), link resetu, komunikat o korzyściach konta | Kluczowe komponenty: `TabbedAuthForm`, `PasswordStrengthMeter`, `GuestContinueCTA`, `ForgotPasswordModal`, `FormErrorList` | UX/A11y/Bezpieczeństwo: aria-describedby dla błędów, maskowanie haseł z opcją podglądu, dynamiczne komunikaty 401/422, blokada wielokrotnych prób (alert 429), przekierowanie po sukcesie na poprzedni flow | Powiązane API: `POST /auth/v1/signup`, `POST /auth/v1/token?grant_type=password`, `POST /auth/v1/recover`, `GET /api/users/me/profile` | User stories: US-005 | Spełnia wymagania: logowanie i autoryzacja (PRD sekcja 3 i 5), bezpieczeństwo haseł (PRD sekcja 7).
- Strona główna | Ścieżka: `/` | Główny cel: wprowadzenie do aplikacji, szybkie wyszukiwanie i przekierowanie do kluczowych sekcji | Kluczowe informacje: hero w trybie dark z wyszukiwarką, CTA rejestracji, skróty (Pokédex, Moves, Evolutions, Locations), banner AI chat, sekcja pozyskania gościa | Kluczowe komponenty: `HeroSearch`, `QuickLinkCards`, `HighlightsCarousel`, `AIChatCTA`, `GuestUpsellBanner`, `MarketingCopy` | UX/A11y/Bezpieczeństwo: kontrolowane autofocus (desktop), aria-live dla wyników instant search, alternatywne treści materiałów graficznych, fallback kopii dla kart Evolutions/Locations gdy brak potwierdzonych danych | Powiązane API: `GET /api/pokemon` (popularne/trending), planowana integracja dla kart Evolutions/Locations wymaga potwierdzenia źródeł | User stories: US-001 (inicjacja wyszukiwania), US-004 (CTA do AI) | Spełnia wymagania: wyszukiwarka (PRD sekcja 3), guidance dla problemów pamięciowych (PRD sekcja 2); Punkty bólu: brak danych dla Evolutions/Locations -> tymczasowa treść informacyjna i link do listy Pokémonów.
- Lista Pokémonów (Pokédex) | Ścieżka: `/pokemon` | Główny cel: prezentacja wyników wyszukiwania z filtrowaniem i sortowaniem zgodnym z API | Kluczowe informacje: grid kart (nazwa, sprite, typy), panel filtrów (typ, generacja, region), sortowanie (name, pokedex, cachedAt), paginacja, komunikaty empty/limit | Kluczowe komponenty: `SearchHeader`, `FilterSidePanel` (desktop pin, mobile slide-over), `FilterChips`, `SortBar`, `PokemonGrid`, `PaginationControls`, `EmptyStateWithAI`, `ListSkeleton` | UX/A11y/Bezpieczeństwo: stan filtrów w URL i `useSearchStore`, focus management w panelu mobilnym, aria-controls i aria-expanded dla filtrów, inline obsługa błędów 400/429/500 z możliwością ponowienia | Powiązane API: `GET /api/pokemon` | User stories: US-001 | Spełnia wymagania: wyszukiwarka i filtry (PRD sekcja 3), empty state kierujący do czatu AI (US-004), responsywność (PRD sekcja 7).
- Szczegóły Pokémona | Ścieżka: `/pokemon/:id` | Główny cel: prezentacja szczegółowego profilu Pokémona oraz zarządzanie ulubionymi | Kluczowe informacje: sprite'y, nazwa, typy, statystyki bazowe, opis, status cache, ewolucje (timeline), moves (sekcja zwijana), metadane (region, generacja), CTA dodania do ulubionych | Kluczowe komponenty: `PokemonHeroBanner`, `StatsBar`, `TypeChips`, `EvolutionTimeline`, `MovesAccordion`, `FavoriteToggle`, `DataAlert`, `DetailSkeleton`, `Breadcrumb` | UX/A11y/Bezpieczeństwo: alt text dla sprite, aria-expanded na akordeonie, tooltipy moves, blokada `FavoriteToggle` bez sesji (wyzwala modal), obsługa 404 z linkiem powrotu i toasty dla 401/429 | Powiązane API: `GET /api/pokemon/{pokemonId}?include=moves,evolutions`, `POST /api/users/me/favorites`, `DELETE /api/users/me/favorites/{pokemonId}` | User stories: US-002, US-003 | Spełnia wymagania: podgląd statystyk, ulubione, bezpieczeństwo dostępu (PRD sekcja 3, 5, 7).
- Katalog ruchów | Ścieżka: `/moves` | Główny cel: przegląd ruchów z filtrowaniem i sortowaniem według parametrów API | Kluczowe informacje: tabela/karty z nazwą, typem, mocą, dokładnością, PP, generacją, filtry typu/regionu/mocy, paginacja | Kluczowe komponenty: `MovesFilterPanel`, `MovesSortBar`, `MovesTable` (z przełączeniem lista/karty), `MovesSkeleton`, `EmptyState`, `InlineErrorBanner` | UX/A11y/Bezpieczeństwo: aria-sort na kolumnach, responsywne renderowanie tabeli, walidacja zakresów min/max mocy, komunikaty 429/500, brak wymogu auth | Powiązane API: `GET /api/moves` | User stories: US-006 | Spełnia wymagania: kolekcje ruchów (PRD sekcja 3), zgodność z dostępnością tabel (PRD sekcja 7).
- Ulubione | Ścieżka: `/favorites` | Główny cel: przegląd i zarządzanie ulubionymi Pokémonami w porządku odwrotnie chronologicznym | Kluczowe informacje: lista kart z datą dodania, typami, przyciskiem usuń, sortowanie (createdAt/name), komunikat pusty + CTA do wyszukiwarki | Kluczowe komponenty: `FavoritesGuard` (modal logowania dla gości), `FavoritesList`, `SortToggle`, `RemoveFavoriteAction`, `FavoritesSkeleton`, `EmptyStateWithSearchCTA` | UX/A11y/Bezpieczeństwo: blokada treści bez JWT (modal z tab focus), potwierdzenie usunięcia (dialog), obsługa 401/403/429 w toastach, powrót focusu do listy po akcji, informacja o rate limit | Powiązane API: `GET /api/users/me/favorites`, `DELETE /api/users/me/favorites/{pokemonId}` | User stories: US-003 | Spełnia wymagania: mechanizm ulubionych i bezpieczeństwo dostępu (PRD sekcja 3, 5, 7).
- Czat AI | Ścieżka: `/ai` | Główny cel: identyfikacja Pokémona na podstawie opisu użytkownika bez przechowywania historii | Kluczowe informacje: bieżąca transkrypcja sesji, pole promptu (min 10/max 500 znaków), sugerowane podpowiedzi, odpowiedzi z confidence i linkami do detali, komunikaty limitów | Kluczowe komponenty: `AIChatPanel`, `PromptInput`, `SuggestionChips`, `ChatTranscript` (aria-live polite), `SuggestionCards`, `RateLimitAlert`, `ChatSkeleton` | UX/A11y/Bezpieczeństwo: aria-live dla odpowiedzi, walidacja promptu przed wysłaniem, messaging domenowy (Pokemon-only), obsługa 429/500 z fallback copy, CTA do logowania przy próbie dodania sugestii do ulubionych | Powiązane API: `POST /api/ai/identify`, opcjonalnie `GET /api/users/me/ai-queries` dla zalogowanych | User stories: US-004 | Spełnia wymagania: czat AI (PRD sekcja 3 i 5), adresowanie pain pointu wyszukiwania opisowego (PRD sekcja 2).

## 3. Mapa podróży użytkownika
- Wejście (gość): użytkownik trafia na `/`, widzi hero i CTA rejestracji, może przejść jako gość lub zalogować się z nagłówka.
- Wyszukiwanie i filtry: wpis w hero przenosi do `/pokemon` z aktywnym zapytaniem; użytkownik doprecyzowuje filtry w panelu bocznym, a wyniki aktualizują się bez przeładowania.
- Przegląd szczegółów: kliknięcie karty otwiera `/pokemon/:id`, breadcrumbs pozwalają wrócić do listy z zachowanym stanem scrolla i filtrów; użytkownik eksploruje statystyki, moves i ewolucje.
- Dodawanie do ulubionych: próba zapisania jako gość wywołuje `FavoritesGuard` z opcją logowania/rejestracji; po udanej autoryzacji stan `useFavoritesStore` aktualizuje się i przycisk pokazuje sukces.
- Fallback do czatu AI: w przypadku braku wyników na liście użytkownik wybiera CTA, które otwiera `/ai`; chat oferuje sugerowane prompty i zwraca listę Pokémonów do dalszej eksploracji.
- Odkrywanie ruchów i skrótów: z nawigacji lub kart skrótów użytkownik przechodzi do `/moves`, filtruje ruchy, a z kart pokémonów może wchodzić w szczegóły bez utraty kontekstu.
- Obsługa błędów: globalne toasty oraz inline bannery informują o 401/429/500; użytkownik ma opcję ponowienia zapytania lub powrotu do home, a w przypadku 403 na Favorites modal proponuje logowanie.

## 4. Układ i struktura nawigacji
- Górny `HeaderBar` zawiera logo (link do `/`), linki `Pokédex`, `Moves`, `Favorites`, `AI Chat`, wbudowane CTA logowania/rejestracji oraz wskaźnik sesji; aktywna zakładka jest wyróżniona.
- Mobile wykorzystuje `MobileDrawer` otwierany ikoną hamburgera, który replikuje linki i CTA, utrzymując focus trap i zamykanie klawiszem Escape zgodnie z dostępnością.
- W widoku szczegółów wprowadzony jest `Breadcrumb` (`Pokédex > [Pokemon]`) ułatwiający powrót przy zachowaniu stanu listy.
- Footer (opcjonalny) zawiera linki pomocnicze (polityka, kontakt) oraz przełącznik języka, bez rozpraszania głównej nawigacji.
- Globalne wyszukiwanie w nagłówku (ikonka lupy) może otwierać modal quick search, jednak główny przepływ utrzymuje hero search na stronie głównej.

## 5. Kluczowe komponenty
- `HeaderBar` i `ResponsiveDrawer`: wspólny szkielet nawigacyjny z obsługą sesji użytkownika, powiadomień i przełącznika motywu zgodny z wymaganiami dostępności.
- `SearchAndFilterSuite`: zestaw `HeroSearch`, `SearchHeader`, `FilterSidePanel`, `FilterChips` i `SortBar`, który utrzymuje spójne doświadczenie wyszukiwania oraz mapuje parametry na zapytania `/api/pokemon`.
- `PokemonCard` oraz `SuggestionCard`: modułowe kafelki wykorzystywane w liście wyników, ulubionych i odpowiedziach AI, wspierające skeletony, akcje hover oraz CTA szczegółów.
- `PokemonDetailModules`: `PokemonHeroBanner`, `StatsBar`, `EvolutionTimeline`, `MovesAccordion`, `FavoriteToggle`, które razem dostarczają pełną narrację detalu i integrują się z ulubionymi.
- `MovesDataTable`: komponent tabelaryczny z adaptacją do layoutu kartowego na mobile, obsługujący sortowanie, filtrację i empty states zgodnie z wymaganiami US-006.
- `FeedbackLayer`: `FavoritesGuardModal`, `ToastStack`, `InlineErrorBanner`, `EmptyStateWithAI`, które adresują błędy, rate limit i motywują do alternatywnych działań (np. AI chat, logowanie).
